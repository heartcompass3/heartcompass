---
import BaseLayout from '../../layouts/BaseLayout.astro';
import site from '../../content/pages/site.json';
import { getCollection } from 'astro:content';

const posts = (await getCollection('posts'))
  .sort((a,b) => b.data.date.valueOf() - a.data.date.valueOf());

const title = `מאמרים | ${site.brand}`;
const description = 'מאמרים, תובנות וכלים מעשיים מתוך מצפן הלב.';
---

<BaseLayout title={title} description={description}>
  <section class="animate-fade-in py-24 bg-background min-h-screen">
    <div class="max-w-7xl mx-auto px-6">
      <header class="mb-16 text-center">
        <h1 class="text-6xl font-black text-primary font-display mb-6 drop-shadow-sm">מילים שנוגעות בלב</h1>
        <p class="text-2xl text-primary/70 font-body font-medium max-w-3xl mx-auto">תובנות, סיפורים וכלים מעשיים מהקליניקה ומהחיים.</p>
      </header>

      <div class="grid gap-12 md:grid-cols-2 lg:grid-cols-3">
        {posts.map((p) => (
          <a href={`/blog/${p.slug}`} class="bg-white rounded-[2.5rem] shadow-xl hover:shadow-[0_30px_60px_-15px_rgba(0,0,0,0.15)] transition-all duration-500 border border-white/50 flex flex-col h-full overflow-hidden hover:-translate-y-3 cursor-pointer group ring-1 ring-black/5 relative">
            <div class="h-56 overflow-hidden relative w-full">
              <img src={p.data.coverImage || '/assets/yossi-hero.jpg'} alt={p.data.title} class="w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-[1.5s]" loading="lazy" />
              <div class="absolute top-6 right-6 bg-white/95 px-4 py-1.5 text-xs font-bold text-primary rounded-full shadow-lg z-20">
                {new Date(p.data.date).toLocaleDateString('he-IL')}
              </div>
            </div>
            <div class="p-10 flex-1 flex flex-col text-center items-center w-full">
              <h2 class="text-2xl font-black text-primary mb-4 font-display leading-tight group-hover:text-gold-dark transition-colors">{p.data.title}</h2>
              <p class="text-primary/70 font-body leading-relaxed mb-8 font-medium line-clamp-3 text-lg">{p.data.excerpt}</p>
              <div class="mt-auto flex items-center text-accent font-bold tracking-wide group-hover:gap-2 transition-all">קרא עוד <span class="mr-2">←</span></div>
            </div>
          </a>
        ))}
      </div>
    </div>
  </section>
</BaseLayout>
